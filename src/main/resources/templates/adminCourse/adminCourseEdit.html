<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>강의 수정</title>
    <link rel="stylesheet" href="/admincss/adminHeader.css">
    <link rel="stylesheet" href="/admincss/adminFooter.css">
    <link rel="stylesheet" href="/admincss/adminSidebar.css">
    <link rel="stylesheet" href="/admincss/adminCommon.css">
    <link rel="stylesheet" href="/admincss/adminCourseEdit.css">
</head>

<body>
    <div th:replace="~{adminHeader :: header}"></div>
    <div th:replace="~{adminSidebar :: sidebar}"></div>

    <main id="container">
        <h3 class="main_title">강의수정</h3>

        <div class="admin_edit_cont">
            <form id="admin_course_edit_form"
                  class="admin_edit_form"
                  method="post" enctype="multipart/form-data"
                  th:action="@{/admin/course/edit}">

                <!-- 🔥 courseId -->
                <input type="hidden" name="courseId" th:value="${course.course_id}" />

                <!-- 강의명 -->
                <div class="admin_form_group">
                    <label class="form_label_title">강의명</label>
                    <input type="text" id="editCourseTitle" name="courseTitle"
                           th:value="${course.title}" required>
                </div>

                <!-- 분류 -->
                <div class="admin_form_group admin_select_group">
                    <label class="form_label_title">강의 분류</label>
                    <div class="admin_select_row">

                        <label class="form_label_subject">대주제 : </label>
                        <select id="editCourseMainSelect" name="courseMain"
                                class="admin_select_main" required>
                            <option value="">- 대주제를 선택하세요 -</option>
                            <option value="자가" th:selected="${course.top_category == '자가'}">자가 응급 처치</option>
                            <option value="구조자" th:selected="${course.top_category == '구조자'}">구조자 응급 처치</option>
                        </select>

                        <label class="form_label_subject">세부 주제 : </label>
                        <select id="editCourseSubSelect" name="courseSub"
                                class="admin_select_sub" required>
                            <option value="">- 세부 주제를 선택하세요 -</option>
                            <option value="출혈" th:selected="${course.mid_category == '출혈'}">출혈</option>
                            <option value="화상" th:selected="${course.mid_category == '화상'}">화상</option>
                            <option value="기도막힘" th:selected="${course.mid_category == '기도막힘'}">기도 막힘</option>
                            <option value="심정지" th:selected="${course.mid_category == '심정지'}">심정지</option>
                        </select>

                    </div>
                    <p class="form_guide">※ 대주제를 먼저 선택한 후 세부 주제를 선택하세요.</p>
                </div>

                <!-- 과정 설명 -->
                <div class="admin_form_group admin_textarea_group">
                    <label class="form_label_title">강의 과정 설명</label>
                    <textarea id="editCourseDesc" name="courseDesc"
                              class="admin_textarea" rows="5"
                              required
                              th:text="${course.summary}">
                    </textarea>
                </div>

                <!-- 썸네일 -->
                <div class="admin_form_group course_thumb_group">
                    <label class="form_label_title">강의 썸네일</label>
                    <input type="file" id="editCourseThumb" name="courseThumb" accept="image/*">
                    <p class="form_guide">※ 새 이미지를 등록하지 않으면 기존 썸네일이 유지됩니다.</p>

                    <div class="preview_box">
                        <img id="editThumbPreview"
                             th:src="@{'/uploads/' + ${course.image_path}}"
                             alt="썸네일 미리보기" style="display:block;">
                    </div>
                </div>

                <!-- 🔥 강의 영상 1~3: 기존 제목, 자막 자동 로딩 -->
                <div class="admin_form_group course_video_group">
    <label class="form_label_title">강의 영상</label>

    <div class="upload_box">

        <!-- 📌 영상 1 -->
        <div class="upload_input">
            <div class="upload_input_header">
                <label class="form_label_videoTitle">제목 1</label>
                <input type="text" id="editVideoTitle1" name="editVideoTitle1"
                       th:value="${lectures.size() > 0 ? lectures[0].title : ''}"
                       required>
            </div>

            <div class="upload_input_box">
                <label for="editCourseVideo1">영상 1</label>
                <input type="file" id="editCourseVideo1" name="courseVideo1" accept="video/*">
            </div>

            <textarea id="editCaption1" name="editCaption1"
                      class="subtitle_input"
                      th:text="${lectures.size() > 0 ? lectures[0].information : ''}">
            </textarea>
        </div>

        <!-- 📌 영상 2 -->
        <div class="upload_input">
            <div class="upload_input_header">
                <label class="form_label_videoTitle">제목 2</label>
                <input type="text" id="editVideoTitle2" name="editVideoTitle2"
                       th:value="${lectures.size() > 1 ? lectures[1].title : ''}">
            </div>

            <div class="upload_input_box">
                <label for="editCourseVideo2">영상 2</label>
                <input type="file" id="editCourseVideo2" name="courseVideo2" accept="video/*">
            </div>

            <textarea id="editCaption2" name="editCaption2"
                      class="subtitle_input"
                      th:text="${lectures.size() > 1 ? lectures[1].information : ''}">
            </textarea>
        </div>

        <!-- 📌 영상 3 -->
        <div class="upload_input">
            <div class="upload_input_header">
                <label class="form_label_videoTitle">제목 3</label>
                <input type="text" id="editVideoTitle3" name="editVideoTitle3"
                       th:value="${lectures.size() > 2 ? lectures[2].title : ''}">
            </div>

            <div class="upload_input_box">
                <label for="editCourseVideo3">영상 3</label>
                <input type="file" id="editCourseVideo3" name="courseVideo3" accept="video/*">
            </div>

            <textarea id="editCaption3" name="editCaption3"
                      class="subtitle_input"
                      th:text="${lectures.size() > 2 ? lectures[2].information : ''}">
            </textarea>
        </div>

        <p class="form_guide">※ 새 영상을 업로드하지 않으면 기존 영상이 유지됩니다.</p>
    </div>
</div>

                <!-- 버튼 -->
                <div class="admin_form_btns">
                    <button type="submit" class="admin_edit_btn">수정</button>
                    <a th:href="@{/adminCourse/adminCourseList}" class="admin_cancel_btn">취소</a>
                </div>
            </form>
        </div>
    </main>

    <div th:replace="~{adminFooter :: footer}"></div>

</body>

<script src="/adminjs/adminHtml.js"></script>
<script src="/adminjs/adminCommon.js"></script>
<script src="/adminjs/adminCourseEdit.js"></script>

</html>
