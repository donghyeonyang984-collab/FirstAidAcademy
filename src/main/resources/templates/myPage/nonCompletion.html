<!-- src/main/resources/templates/myPage/nonCompletion.html -->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<body>

<th:block th:fragment="content">

    <!-- 제목 -->
    <h1 th:text="${pageTitle}">미수료</h1>

    <!-- 필터 + 검색 (동작은 courseList와 동일하게 mid만 사용) -->
    <form class="filter-search"
          th:action="@{/myPage/nonCompletion}"
          method="get">

        <!-- 카테고리 필터 -->
        <select class="filter-select" name="mid">
            <option value="" th:selected="${selectedMid == ''}">전체</option>
            <option value="출혈" th:selected="${selectedMid == '출혈'}">출혈</option>
            <option value="기도막힘" th:selected="${selectedMid == '기도막힘'}">기도막힘</option>
            <option value="심정지" th:selected="${selectedMid == '심정지'}">심정지</option>
            <option value="화상" th:selected="${selectedMid == '화상'}">화상</option>
        </select>

        <!-- 검색 박스 -->
        <div class="course-search-box">
            <input
                    type="text"
                    class="course-search-input"
                    name="keyword"
                    placeholder="강의 검색"
                    th:value="${keyword}">
            <button type="submit" class="course-search-btn">
                <i class="fa-solid fa-magnifying-glass"></i>
            </button>
        </div>
    </form>

    <!-- 미수료 강의 리스트 -->
    <section class="completion-section">

        <!-- enrollments : List<EnrollmentListItem> 기준 반복 -->
        <div class="completion-card"
             th:each="item : ${enrollments}">
            <div class="completion-item">

                <!-- 썸네일 -->
                <div class="thumbnail-box">
                    <img th:if="${item.imagePath != null}"
                         th:src="@{|/images/courses/${item.imagePath}|}"
                         alt="강의 썸네일">
                </div>

                <!-- 내용 -->
                <div class="content-box">

                    <!-- 카테고리 태그 -->
                    <div class="status-tags">
                        <div class="category-tags">
                            <!-- 순서는 디자인에 맞춰 mid -> top -->
                            <span th:text="${item.midCategory}">심정지</span>
                            <span th:text="${item.topCategory}">구조자</span>
                        </div>
                    </div>

                    <!-- 강의 제목 + 상태 -->
                    <div class="course-title">
                        <span th:text="${item.title}">응급처치 기초 과정</span>
                        <!-- 이 페이지는 항상 '미수료'로 표기 -->
                        <span class="completion-tag">미수료</span>
                    </div>

                    <!-- 수강 기간(시작일만 표시) -->
                    <div class="course-period">
                        기간:
                        <span th:text="${item.enrolledAt}">2025-11-24T15:00</span>
                        -
                        <span>진행중</span>
                    </div>

                    <!-- 진도율 표시 -->
                    <div class="mycourse-meta">
                        <span class="course-progress-label">진도율</span>
                        <span class="course-progress-value"
                              th:text="${item.progressPercent != null ? item.progressPercent + '%' : '0%'}">
                            0%
                        </span>
                    </div>
                </div>

                <!-- 버튼 영역 (시험/결과 보기 - URL은 나중에 연결) -->
<button class="btn-cert1"
        type="button"
        th:onclick="'location.href=\'/exam?courseId=' + ${item.courseId} + '\';'">
    시험 보기
</button>
            </div>
        </div>

        <!-- 비어 있을 때 -->
        <div class="empty-result"
             th:if="${#lists.isEmpty(enrollments)}"
             style="margin-top: 24px; color:#6b7280; font-size:14px;">
            미수료 강의가 없습니다.
        </div>

    </section>

    <!-- 페이지네이션(지금은 디자인용, 실제 페이징은 나중에) -->
    <div class="pagination" th:if="${!#lists.isEmpty(enrollments)}">
        <button class="page-btn prev">&lt;</button>
        <ul class="page-numbers"></ul>
        <button class="page-btn next">&gt;</button>
    </div>

</th:block>

</body>
</html>
